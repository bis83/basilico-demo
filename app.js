(()=>{const y=(e,t,o)=>{e.addEventListener(t,o)},F=()=>document.getElementById("canvas"),O=()=>document.getElementById("message"),Q=()=>{F().requestPointerLock()},P=()=>document.pointerLockElement===F(),C=e=>{const t=O();t.style.display="",t.textContent=e},Z=()=>{const e=O();e.style.display="none"};const ee=(e,t)=>Math.floor(e/t),te=(e,t)=>(e%t+t)%t,S=e=>e/180*Math.PI;const R=(e,t)=>e[0]*t[0]+e[1]*t[1]+e[2]*t[2],ne=e=>{const t=R(e,e);return Math.sqrt(t)},oe=(e,t)=>[e[0]+t[0],e[1]+t[1],e[2]+t[2]],re=(e,t)=>[e[0]-t[0],e[1]-t[1],e[2]-t[2]];const A=e=>{const t=ne(e);return[e[0]/t,e[1]/t,e[2]/t]},T=(e,t)=>[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]],$=(e,t)=>{const o=S(e),r=S(t);return[Math.cos(r)*Math.cos(o),Math.sin(r),Math.cos(r)*Math.sin(o)]},se=()=>[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ie=(e,t)=>[e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15]],ce=e=>{const t=e[0]*e[5]-e[1]*e[4],o=e[0]*e[6]-e[2]*e[4],r=e[0]*e[7]-e[3]*e[4],n=e[1]*e[6]-e[2]*e[5],s=e[1]*e[7]-e[3]*e[5],i=e[2]*e[7]-e[3]*e[6],c=e[8]*e[13]-e[9]*e[12],f=e[8]*e[14]-e[10]*e[12],l=e[8]*e[15]-e[11]*e[12],m=e[9]*e[14]-e[10]*e[13],u=e[9]*e[15]-e[11]*e[13],d=e[10]*e[15]-e[11]*e[14];let a=t*d-o*u+r*m+n*l-s*f+i*c;return a?(a=1/a,[(e[5]*d-e[6]*u+e[7]*m)*a,(e[2]*u-e[1]*d-e[3]*m)*a,(e[13]*i-e[14]*s+e[15]*n)*a,(e[10]*s-e[9]*i-e[11]*n)*a,(e[6]*l-e[4]*d-e[7]*f)*a,(e[0]*d-e[2]*l+e[3]*f)*a,(e[14]*r-e[12]*i-e[15]*o)*a,(e[8]*i-e[10]*r+e[11]*o)*a,(e[4]*u-e[5]*l+e[7]*c)*a,(e[1]*l-e[0]*u-e[3]*c)*a,(e[12]*s-e[13]*r+e[15]*t)*a,(e[9]*r-e[8]*s-e[11]*t)*a,(e[5]*f-e[4]*m-e[6]*c)*a,(e[0]*m-e[1]*f+e[2]*c)*a,(e[13]*o-e[12]*n-e[14]*t)*a,(e[8]*n-e[9]*o+e[10]*t)*a]):se()};const ae=(e,t,o,r)=>{e[12]=t,e[13]=o,e[14]=r},de=(e,t)=>{const o=S(e),r=Math.sin(o),n=Math.cos(o);return[n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1]};const fe=(e,t,o)=>{const r=A(re(t,e)),n=A(T(o,r)),s=T(r,n),i=R(e,n),c=R(e,s),f=R(e,r);return[n[0],s[0],r[0],0,n[1],s[1],r[1],0,n[2],s[2],r[2],0,-i,-c,-f,1]},le=(e,t,o,r)=>{const n=1/Math.tan(e),s=n/t,i=r/(r-o),c=-(i*o);return[s,0,0,0,0,n,0,0,0,0,i,1,0,0,c,0]};const ue=async(e,t)=>{e.adapter=await navigator.gpu.requestAdapter(),e.device=await e.adapter.requestDevice(),e.canvasFormat=navigator.gpu.getPreferredCanvasFormat(),e.canvas=F(),e.context=e.canvas.getContext("webgpu"),e.context.configure({device:e.device,format:e.canvasFormat,alphaMode:"opaque"});const o=e.device;if(e.buffer)for(let n=0;n<e.buffer.length;++n){const s=e.buffer[n],i=await Fe(t[s.embed]),c=o.createBuffer({size:i.length,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.INDEX,mappedAtCreation:!0}),f=new DataView(c.getMappedRange());for(let l=0;l<i.length;++l)f.setUint8(l,i[l]);c.unmap(),e.buffer[n]=c}if(e.shader)for(let n=0;n<e.shader.length;++n){const s=e.shader[n],i=await Me(t[s.embed]),c=o.createShaderModule({code:i});e.shader[n]=c}e.bindGroupLayout=[],e.pipelineLayout=[],e.pipeline=[],e.sampler=[],e.bindGroup=[],e.cbuffer=[],e.gbuffer=[];const r=(n,s,i)=>{e.cbuffer[n]=o.createBuffer({size:s,usage:i|GPUBufferUsage.COPY_DST})};r(0,512,GPUBufferUsage.UNIFORM),r(1,229376,GPUBufferUsage.STORAGE),r(2,65536,GPUBufferUsage.VERTEX),r(3,40960,GPUBufferUsage.INDIRECT),r(4,49152,GPUBufferUsage.VERTEX),r(5,16384,GPUBufferUsage.VERTEX),e.sampler[0]=o.createSampler({magFilter:"linear",minFilter:"linear",mipmapFilter:"linear"}),e.bindGroupLayout[0]=o.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{}},{binding:1,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"read-only-storage"}}]}),e.bindGroupLayout[1]=o.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{}},{binding:1,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"depth"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{}},{binding:4,visibility:GPUShaderStage.FRAGMENT,texture:{}},{binding:5,visibility:GPUShaderStage.FRAGMENT,sampler:{}}]}),e.pipelineLayout[0]=o.createPipelineLayout({bindGroupLayouts:[e.bindGroupLayout[0]]}),e.pipelineLayout[1]=o.createPipelineLayout({bindGroupLayouts:[e.bindGroupLayout[1]]}),e.bindGroup[0]=o.createBindGroup({layout:e.bindGroupLayout[0],entries:[{binding:0,resource:{buffer:e.cbuffer[0]}},{binding:1,resource:{buffer:e.cbuffer[1]}}]}),ve(e)},me=(e,t)=>{for(let o=0;o<e.id.length;++o)if(e.id[o].name===t)return o;return-1},he=(e,t)=>{const o=e.device,r=new Float32Array(68);{const n=t.camera,s=e.canvas.width/e.canvas.height,i=S(n.fov),[c,f,l,m,u]=U(n.offset,0,0,0,0,0),d=$(m,u),a=[c,f,l],h=oe(a,d),p=fe(a,h,[0,1,0]),x=le(i,s,n.near,n.far),B=ie(p,x),E=ce(B);r.set(B,0),r.set(E,16),r.set(p,32),r.set(a,48)}{const n=t.light,[s,i,c,f,l]=U(n.offset,0,0,0,0,0),m=_(n.color,0,0,0,0),u=_(n.ambient0,0,0,0,0),d=_(n.ambient1,0,0,0,0),a=$(f,l);r.set(a,52),r.set(m,56),r.set(u,60),r.set(d,64)}o.queue.writeBuffer(e.cbuffer[0],0,r)},be=(e,t)=>{const o=e.device;if(!t.lines||t.lines.length<=0)return 0;const r=new Float32Array(t.lines.length*3),n=new Uint8Array(t.lines.length*4);for(let s=0;s<t.lines.length;++s){const i=t.lines[s];r[s*3+0]=i.pos[0],r[s*3+1]=i.pos[1],r[s*3+2]=i.pos[2],n[s*4+0]=i.color[0],n[s*4+1]=i.color[1],n[s*4+2]=i.color[2],n[s*4+3]=i.color[3]}return o.queue.writeBuffer(e.cbuffer[4],0,r),o.queue.writeBuffer(e.cbuffer[5],0,n),t.lines.length},ye=(e,t,o)=>{const r=e.device,n=[];n.length=e.mesh.length;for(let d=0;d<n.length;++d)n[d]=[];const s=new Float32Array(28),i=4*28;let c=0;for(const d of t.room){const a=$e(o,d.name);if(a)for(let h=0;h<a.indices.length;++h){const G=a.node[a.indices[h]];if(!G)continue;const p=te(h,a.divisor),x=ee(h,a.divisor),[B,E,D,I,k]=U(d.offset,p*a.unit,0,x*a.unit,0,0);for(const z of G.mesh){const w=a.mesh[z];if(!w)continue;const M=me(e,w.name);if(M<0)continue;for(const K of e.id[M].mesh)n[K].push(c);const[q,N,X,H,W]=U(w.offset,B,E,D,I,k),L=de(H,W);ae(L,q,N,X);const j=_(w.factor0,1,1,1,1),Y=_(w.factor1,1,1,1,0),J=_(w.factor2,0,0,0,0);s.set(L,0),s.set(j,16),s.set(Y,20),s.set(J,24),r.queue.writeBuffer(e.cbuffer[1],c*i,s),c+=1}}}const f=[];let l=0,m=0;const u=new Uint32Array(5);for(let d=0;d<n.length;++d){if(n[d].length<=0)continue;const a=e.mesh[d],h=n[d].length;r.queue.writeBuffer(e.cbuffer[2],l*4,new Uint32Array(n[d])),u[0]=a.count,u[1]=h,u[2]=0,u[3]=0,u[4]=0,r.queue.writeBuffer(e.cbuffer[3],m,u),f.push({id:d,first:l,offset:m}),l+=h,m+=20}return f},ge=e=>{const t=e.device,o=e.canvas;if(o.width!==o.clientWidth||o.height!==o.clientHeight){o.width=o.clientWidth,o.height=o.clientHeight;const s=c=>{e.gbuffer[c]!==void 0&&(e.gbuffer[c].destroy(),delete e.gbuffer[c])};s(0),s(1),s(2),s(3),s(4);const i=c=>{e.bindGroup[c]!==void 0&&delete e.bindGroup[c]};i(1),i(2),i(3)}const r=(s,i)=>{e.gbuffer[s]===void 0&&(e.gbuffer[s]=t.createTexture({size:[o.width,o.height],format:i,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}))};r(0,"depth32float"),r(1,"rgb10a2unorm"),r(2,"rgba8unorm"),r(3,"rgba8unorm"),r(4,"rgba16float");const n=(s,i,c,f,l)=>{e.bindGroup[s]===void 0&&(e.bindGroup[s]=t.createBindGroup({layout:e.bindGroupLayout[1],entries:[{binding:0,resource:{buffer:e.cbuffer[0]}},{binding:1,resource:e.gbuffer[i].createView()},{binding:2,resource:e.gbuffer[c].createView()},{binding:3,resource:e.gbuffer[f].createView()},{binding:4,resource:e.gbuffer[l].createView()},{binding:5,resource:e.sampler[0]}]}))};n(1,0,1,2,3),n(2,0,1,1,1),n(3,0,4,4,4)},ve=e=>{const t=e.device;e.pipeline[0]=t.createRenderPipeline({layout:e.pipelineLayout[0],vertex:{module:e.shader[0],entryPoint:"VS",buffers:[{arrayStride:4,attributes:[{format:"uint32",offset:0,shaderLocation:0}],stepMode:"instance"},{arrayStride:12,attributes:[{format:"float32x3",offset:0,shaderLocation:1}]},{arrayStride:12,attributes:[{format:"float32x3",offset:0,shaderLocation:2}]}]},fragment:{module:e.shader[0],entryPoint:"FS",targets:[{format:"rgb10a2unorm"},{format:"rgba8unorm"},{format:"rgba8unorm"},{format:"rgba16float"}]},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth32float"},primitive:{cullMode:"back",frontFace:"cw"}}),e.pipeline[1]=t.createRenderPipeline({layout:e.pipelineLayout[1],vertex:{module:e.shader[1],entryPoint:"VS",buffers:[]},fragment:{module:e.shader[1],entryPoint:"FS_SSAO",targets:[{format:"rgba8unorm",blend:{color:{operation:"min",srcFactor:"one",dstFactor:"one"},alpha:{}},writeMask:GPUColorWrite.RED}]}}),e.pipeline[2]=t.createRenderPipeline({layout:e.pipelineLayout[1],vertex:{module:e.shader[1],entryPoint:"VS",buffers:[]},fragment:{module:e.shader[1],entryPoint:"FS_HDR",targets:[{format:"rgba16float",blend:{color:{operation:"add",srcFactor:"one",dstFactor:"one"},alpha:{}}}]},depthStencil:{depthWriteEnabled:!1,depthCompare:"not-equal",format:"depth32float"}}),e.pipeline[3]=t.createRenderPipeline({layout:e.pipelineLayout[1],vertex:{module:e.shader[1],entryPoint:"VS",buffers:[]},fragment:{module:e.shader[1],entryPoint:"FS_HDRSky",targets:[{format:"rgba16float",blend:{color:{operation:"add",srcFactor:"one",dstFactor:"one"},alpha:{}}}]},depthStencil:{depthWriteEnabled:!1,depthCompare:"equal",format:"depth32float"}}),e.pipeline[4]=t.createRenderPipeline({layout:e.pipelineLayout[1],vertex:{module:e.shader[1],entryPoint:"VS",buffers:[]},fragment:{module:e.shader[1],entryPoint:"FS_HDR2LDR",targets:[{format:e.canvasFormat}]},depthStencil:{depthWriteEnabled:!1,depthCompare:"always",format:"depth32float"}}),e.pipeline[5]=t.createRenderPipeline({layout:e.pipelineLayout[0],vertex:{module:e.shader[2],entryPoint:"VS",buffers:[{arrayStride:12,attributes:[{format:"float32x3",offset:0,shaderLocation:0}]},{arrayStride:4,attributes:[{format:"unorm8x4",offset:0,shaderLocation:1}]}]},fragment:{module:e.shader[2],entryPoint:"FS",targets:[{format:e.canvasFormat}]},depthStencil:{depthWriteEnabled:!1,depthCompare:"less",format:"depth32float"},primitive:{topology:"line-list"}})},pe=e=>{ge(e)},we=(e,t,o)=>{he(e,t);const r=ye(e,t,o),n=be(e,t),s=e.device,i=s.createCommandEncoder();_e(i,e,r),Se(i,e),Ge(i,e),xe(i,e,n),s.queue.submit([i.finish()])},_e=(e,t,o)=>{const r=e.beginRenderPass({depthStencilAttachment:{view:t.gbuffer[0].createView(),depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store"},colorAttachments:[{view:t.gbuffer[1].createView(),clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"},{view:t.gbuffer[2].createView(),clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"},{view:t.gbuffer[3].createView(),clearValue:{r:1,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"},{view:t.gbuffer[4].createView(),clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"}]});for(const n of o){r.setPipeline(t.pipeline[0]),r.setBindGroup(0,t.bindGroup[0]),r.setVertexBuffer(0,t.cbuffer[2],n.first*4);const s=t.mesh[n.id];if(s.vb0){const[i,c,f]=s.vb0;r.setVertexBuffer(1,t.buffer[i],c,f)}if(s.vb1){const[i,c,f]=s.vb1;r.setVertexBuffer(2,t.buffer[i],c,f)}if(s.ib){const[i,c,f]=s.ib;r.setIndexBuffer(t.buffer[i],"uint16",c,f)}r.drawIndexedIndirect(t.cbuffer[3],n.offset)}r.end()},Se=(e,t)=>{const o=e.beginRenderPass({colorAttachments:[{view:t.gbuffer[3].createView(),loadOp:"load",storeOp:"store"}]});o.setPipeline(t.pipeline[1]),o.setBindGroup(0,t.bindGroup[2]),o.draw(4),o.end()},Ge=(e,t)=>{const o=e.beginRenderPass({depthStencilAttachment:{view:t.gbuffer[0].createView(),depthReadOnly:!0},colorAttachments:[{view:t.gbuffer[4].createView(),loadOp:"load",storeOp:"store"}]});o.setPipeline(t.pipeline[2]),o.setBindGroup(0,t.bindGroup[1]),o.draw(4),o.setPipeline(t.pipeline[3]),o.draw(4),o.end()},xe=(e,t,o)=>{const r=e.beginRenderPass({depthStencilAttachment:{view:t.gbuffer[0].createView(),depthReadOnly:!0},colorAttachments:[{view:t.context.getCurrentTexture().createView(),clearValue:{r:0,g:0,b:0,a:0},loadOp:"clear",storeOp:"store"}]});r.setPipeline(t.pipeline[4]),r.setBindGroup(0,t.bindGroup[3]),r.draw(4),o&&(r.setPipeline(t.pipeline[5]),r.setBindGroup(0,t.bindGroup[0]),r.setVertexBuffer(0,t.cbuffer[4]),r.setVertexBuffer(1,t.cbuffer[5]),r.draw(o)),r.end()},g=(e,t,o)=>{o=o||0;const r=e[t];r&&!r.hold&&(r.value=Math.max(0,o))},v=(e,t,o,r)=>{o=o||0,r=r||!1;const n=e[t];n&&(n.value=Math.max(0,o),n.hold=r)},V=(e,t)=>{const o=e[t];return o?o.value:0},Pe=e=>{const t=()=>{for(const n in e.keyboard)v(e.signal,e.keyboard[n],0,!1);for(const n of e.mouse.button)v(e.signal,n,0,!1)},o=(n,s,i)=>{if(!P())return;const c=e.keyboard[n.code];c&&(v(e.signal,c,s,i),n.preventDefault())},r=(n,s,i)=>{if(!P())return;const c=e.mouse.button[n.button];c&&(v(e.signal,c,s,i),n.preventDefault())};y(document.body,"contextmenu",n=>{n.preventDefault()}),y(window,"gamepadconnected",n=>{const s=e.gamepad;s.id=n.gamepad.index}),y(window,"gamepaddisconnected",n=>{const s=e.gamepad;s.id===n.gamepad.index&&(s.id=null)}),y(document,"click",n=>{P()||(Q(),t())}),y(document,"keydown",n=>{o(n,1,!0)}),y(document,"keyup",n=>{o(n,0,!1)}),y(document,"mousedown",n=>{r(n,1,!0)}),y(document,"mouseup",n=>{r(n,0,!1)}),y(document,"mousemove",n=>{if(!P())return;const s=.25,i=e.mouse.movementX;i&&(g(e.signal,i[0],-n.movementX*s),g(e.signal,i[1],n.movementX*s));const c=e.mouse.movementY;c&&(g(e.signal,c[0],-n.movementY*s),g(e.signal,c[1],n.movementY*s)),n.preventDefault()}),y(window,"blur",n=>{t()})},Be=(e,t)=>{{const o=e.timer,r=V(e.signal,o.time),n=V(e.signal,o.frameCount),s=(t-r)/1e3;v(e.signal,o.time,t,!0),v(e.signal,o.deltaTime,s,!0),v(e.signal,o.frameCount,n+1,!0)}if(!P()){const o=e.gamepad;if(o.id!==null){const r=navigator.getGamepads()[o.id];for(let n=0;n<r.buttons.length;++n){const s=o.buttons[n];s&&g(e.signal,s,r.buttons[n].value)}for(let n=0;n<r.axes.length;++n){const s=o.axes[n];if(!s)continue;const i=Math.trunc(r.axes[n]*4)/4;g(e.signal,s[0],-i),g(e.signal,s[1],i)}}}},Re=e=>{e.func.update&&e.func.update(e)},Ue=e=>{for(const t in e.signal)g(e.signal,t,0)},Ee=(e,t)=>{e.lines=[];for(const o of t)e.lines.push({pos:o.from,color:o.color}),e.lines.push({pos:o.to,color:o.color})},U=(e,t,o,r,n,s)=>(e&&(t+=e.x||0,o+=e.y||0,r+=e.z||0,n+=e.ha||0,s+=e.va||0),[t,o,r,n,s]),_=(e,t,o,r,n)=>(e&&(e.r!==void 0&&(t=e.r),e.g!==void 0&&(o=e.g),e.r!==void 0&&(r=e.b),e.a!==void 0&&(n=e.a)),[t,o,r,n]),Ve=(e,t)=>{e.loading+=1,(async()=>{const n=await(await fetch("app.json")).json();Object.assign(e,n),e.gpu&&await ue(e.gpu,e.embed),e.func&&Pe(e.func),t&&t(e),delete e.embed,e.loading-=1})()},Fe=async e=>{const t=window.atob(e),o=new Uint8Array(t.length);for(let s=0;s<t.length;++s)o[s]=t.charCodeAt(s);const r=new Blob([o]).stream().pipeThrough(new DecompressionStream("deflate-raw")),n=await new Response(r).arrayBuffer();return new Uint8Array(n)},Me=async e=>{const t=window.atob(e),o=new Uint8Array(t.length);for(let s=0;s<t.length;++s)o[s]=t.charCodeAt(s);const r=new Blob([o]).stream().pipeThrough(new DecompressionStream("deflate-raw"));return await new Response(r).text()},Le=async e=>{if(!navigator.gpu){C("ERROR: WebGPU not supported.");return}const t={loading:0};Ve(t,e);const o=r=>{Ae(t)&&(Be(t.func,r),pe(t.gpu),Re(t),we(t.gpu,t.view,t),Ue(t.func)),requestAnimationFrame(o)};requestAnimationFrame(o)},Ae=e=>e.loading<=0,Te=(e,t)=>e.json[t],$e=(e,t)=>e.room[t],b=(e,t)=>V(e.func.signal,t),Oe=e=>{Z(),Object.assign(e.view,Te(e,"sample")),De(e),e.func.update=Ce},Ce=e=>{const t=e.view,o=t.camera,r=b(e,"dt"),n=[0,0];n[0]+=-b(e,"l0"),n[0]+=b(e,"l1"),n[1]+=b(e,"l2"),n[1]+=-b(e,"l3");const s=[0,0];if(s[0]+=-b(e,"r0"),s[0]+=b(e,"r1"),s[1]+=b(e,"r2"),s[1]+=-b(e,"r3"),s){const m=-s[0],u=s[1];o.offset.ha+=90*r*m,o.offset.va+=90*r*u,o.offset.va=Math.max(-60,Math.min(o.offset.va,80))}if(n){const m=S(o.offset.ha+90),u=S(o.offset.ha),d=-n[0],a=n[1],h=d*Math.cos(m)+a*Math.cos(u),G=d*Math.sin(m)+a*Math.sin(u),p=2*r*h,x=2*r*G;o.offset.x+=p,o.offset.z+=x}b(e,"a2")&&(o.offset.y-=.75*r),b(e,"a3")&&(o.offset.y+=.75*r);const f=t.light;f.offset.ha+=45*r};y(window,"load",()=>{C("Welcome Basilico."),Le(Oe)});const De=e=>{const t=[];t.push({from:[-50,0,0],to:[50,0,0],color:[255,0,0,255]}),t.push({from:[0,0,-50],to:[0,0,50],color:[0,0,255,255]}),Ee(e.view,t)};})();
